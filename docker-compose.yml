services:
  tirotime-web:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: tirotime-app
    restart: always
    env_file:
      - .env
    ports:
      - "5000:80"
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=http://+:80
      # Database Connection - verwendet host.docker.internal um auf Host-SQL-Server zuzugreifen
      - ConnectionStrings__DefaultConnection=Server=host.docker.internal;Database=TiroTime;User Id=usrTiroTime;Password=P@ssw0rd;TrustServerCertificate=True;MultipleActiveResultSets=true
      # Note: SeedUsers and JWT settings are configured in .env file
      # JWT Settings (keeping for reference, actual values from .env)
      - JwtSettings__SecretKey=TiroTime_SuperSecretKey_MinLength32Characters_ChangeInProduction!
      - JwtSettings__Issuer=TiroTime
      - JwtSettings__Audience=TiroTimeUsers
      - JwtSettings__ExpirationInMinutes=480
      - JwtSettings__RefreshTokenExpirationInDays=7
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      - tirotime-network

networks:
  tirotime-network:
    driver: bridge
